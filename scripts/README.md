# 部署脚本使用说明

本目录包含了自动构建和 FTP 部署脚本，可以快速将项目部署到远程服务器。

## 文件说明

- `deploy.js` - 主要的部署脚本
- `ftp.config.js` - FTP 连接配置文件
- `README.md` - 本说明文件

## 安装依赖

首先确保已安装 FTP 客户端库：

```bash
npm install
```

## 配置 FTP 连接

编辑 `scripts/ftp.config.js` 文件，修改您的 FTP 服务器信息：

```javascript
module.exports = {
    // FTP 服务器配置
    host: '您的服务器地址',
    user: '您的用户名',
    password: '您的密码',
    port: 21,
    
    // 部署设置
    settings: {
        // 是否在上传前清理远程目录
        clearRemoteDirectory: true,
        
        // 连接超时时间（毫秒）
        timeout: 10000,
        
        // 远程部署路径（默认为根目录）
        remotePath: '/',
        
        // 本地构建目录（相对于项目根目录）
        buildDir: 'build'
    }
};
```

## 使用方法

### 方法 1: 使用 npm 脚本（推荐）

```bash
# 构建并部署
npm run build:deploy

# 或者仅部署（需要先构建）
npm run deploy
```

### 方法 2: 直接运行脚本

```bash
# 构建并部署
node scripts/deploy.js

# 或者先构建，再部署
npm run build
node scripts/deploy.js
```

## 部署流程

脚本会按以下顺序执行：

1. 📦 **构建项目** - 执行 `npm run build`
2. 🌐 **连接 FTP 服务器** - 使用配置的连接信息
3. 🧹 **清理远程目录** - 删除旧文件（可配置）
4. 📤 **上传新文件** - 将构建结果上传到服务器
5. ✅ **完成部署** - 显示网站访问地址

## 配置选项说明

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| `clearRemoteDirectory` | 是否在上传前清理远程目录 | `true` |
| `timeout` | FTP 连接超时时间（毫秒） | `10000` |
| `remotePath` | 远程部署路径 | `'/'` |
| `buildDir` | 本地构建目录 | `'build'` |

## 注意事项

1. **安全性**: 配置文件包含敏感信息，不要提交到版本控制系统
2. **权限**: 确保 FTP 账户有对应目录的读写权限
3. **网络**: 确保网络连接稳定，特别是在上传大文件时
4. **备份**: 建议在首次部署前备份服务器上的原有文件

## 故障排除

### 连接失败
- 检查服务器地址、端口、用户名和密码
- 确认防火墙设置允许 FTP 连接
- 尝试使用 FTP 客户端软件手动连接测试

### 上传失败
- 检查文件权限
- 确认磁盘空间充足
- 检查文件名是否包含特殊字符

### 构建失败
- 检查项目依赖是否完整：`npm install`
- 确认代码没有语法错误
- 查看构建日志了解具体错误信息 